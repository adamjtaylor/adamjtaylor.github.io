"0",""
"0","beer_growth_op <- beer_states %>%"
"0","  filter(type == ""On Premises"") %>%"
"0","  filter(state != ""total"") %>%"
"0","  filter(barrels >= 500) %>%"
"0","  #mutate(barrels = replace_na(barrels, 0)) %>%"
"0","  group_by(state) %>%"
"0","  mutate(barrels_norm = barrels/max(barrels)) %>%"
"0","  group_nest(state) %>%"
"0","  mutate(model = map(data, ~lm(barrels_norm~year, data = .x)),"
"0","         tidy = map(model, tidy)) %>%"
"0","  unnest(tidy) %>%"
"0","  filter(term == ""year"") %>%"
"0","  select(state, estimate) %>%"
"0","  rename(slope = estimate)"
"2","... is ignored in group_nest(<grouped_df>), please use group_by(..., add = TRUE) %>% group_nest()"
"0","fast_op_growth_states <- beer_growth_op %>% top_n(5, slope) %>% pull(state)"
"0",""
"0","slow_op_growth_states <- beer_growth_op %>% top_n(-5, slope) %>% pull(state)"
"0",""
"0","high_op_prod_states <- beer_states %>%"
"0","  filter(type == ""On Premises"") %>%"
"0","  filter(year == 2018) %>%"
"0","  filter(state != ""total"") %>%"
"0","  ungroup() %>%"
"0","  top_n(5, barrels) %>% "
"0","  pull(state)"
"0",""
"0","slow_op_growth_states"
"1","[1]"
"1"," ""KS"""
"1"," ""MO"""
"1"," ""NM"""
"1"," ""NV"""
"1"," ""UT"""
"1","
"
"0","fast_op_growth_states"
"1","[1]"
"1"," ""GA"""
"1"," ""MI"""
"1"," ""MS"""
"1"," ""MT"""
"1"," ""TX"""
"1","
"
"0","high_op_prod_states"
"1","[1]"
"1"," ""CA"""
"1"," ""CO"""
"1"," ""FL"""
"1"," ""NC"""
"1"," ""TX"""
"1","
"
