"0","beer_states_total <- beer_states %>% "
"0","  #filter(year >= 2013) %>%"
"0","  mutate(barrels = replace_na(barrels, 0)) %>%"
"0","  group_by(state, year) %>%"
"0","  summarise(barrels= sum(barrels)) %>%"
"0","    filter(state != ""total"")"
"0",""
"0",""
"0","beer_growth <- beer_states_total %>%"
"0","  filter(state != ""total"") %>%"
"0","  na.omit() %>%"
"0","  group_by(state) %>%"
"0","  mutate(barrels_norm = barrels/max(barrels)) %>%"
"0","  group_nest(state) %>%"
"0","  mutate(model = map(data, ~lm(barrels_norm~year, data = .x)),"
"0","         tidy = map(model, tidy)) %>%"
"0","  unnest(tidy) %>%"
"0","  filter(term == ""year"") %>%"
"0","  select(state, estimate) %>%"
"0","  rename(slope = estimate)"
"2","... is ignored in group_nest(<grouped_df>), please use group_by(..., add = TRUE) %>% group_nest()"
"0","fast_growth_states <- beer_growth %>% top_n(5, slope) %>% pull(state)"
"0",""
"0","slow_growth_states <- beer_growth %>% top_n(-5, slope) %>% pull(state)"
"0",""
"0","high_prod_states <- beer_states_total %>% filter(year == 2018) %>%"
"0","  filter(state != ""total"") %>%"
"0","  ungroup() %>%"
"0","  top_n(5, barrels) %>% "
"0","  pull(state)"
"0",""
